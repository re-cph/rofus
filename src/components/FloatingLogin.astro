<script type="module">
  var loginContainer = document.querySelector(".login-container");
  var loginHeader = document.querySelector(".login-header");
  var loginDescWrapper = document.querySelector(
    ".login-container-description-wrapper",
  );
  var loginDesc = document.querySelector(".login-container__description");

  function handleIntersection(entries) {
    entries.forEach(function (entry) {
      if (!entry.isIntersecting) {
        loginHeader.classList.add("login-header--sticky");
      } else {
        loginHeader.classList.remove("login-header--sticky");
      }
    });
  }

  var observer = new IntersectionObserver(handleIntersection, {
    threshold: 1,
  });

  var initialHeight = loginDescWrapper.clientHeight + 16; // padding
  loginDesc.style.height = initialHeight + "px";
  function slide() {
    var scrolled = document.documentElement["scrollTop"];
    var height =
      initialHeight -
      (initialHeight + 32 * 2) * (scrolled / window.innerHeight);
    var loginDescWrapperHeight = height + 32;
    loginDescWrapper.style.height = loginDescWrapperHeight + "px";

    var loginContainerHeight = 120 + height + 32;
    loginContainer.style.height = loginContainerHeight + "px";

    var isSticky = loginHeader.classList.contains("login-header--sticky");
    if (isSticky || loginDescWrapperHeight < (isSticky ? 120 : 0)) {
      loginHeader.classList.add("login-header--fully-rounded");
    } else {
      loginHeader.classList.remove("login-header--fully-rounded");
    }
  }

  var isDesktop = function () {
    return window.outerWidth > 660;
  };

  function initLoginContainer() {
    observer.unobserve(loginContainer);
    if (isDesktop()) {
      observer.observe(loginContainer);
    } else {
      loginHeader.classList.remove("login-header--sticky");
      loginDescWrapper.style.height = "auto";
      loginDesc.style.height = "auto";
    }
  }

  window.onscroll = function () {
    if (isDesktop()) {
      slide();
    }
  };

  window.onresize = function () {
    initLoginContainer();
  };

  initLoginContainer();
</script>

<div class="header-content">
  <div role="region" aria-labelledby="header" class="wrapper">
    <div class="container">
      <div class="login-container">
        <!--  login-container--desktop -->
        <a
          class="login-header"
          target="_blank"
          href="https://rofusweb.spillemyndigheden.dk/public/rofus/"
        >
          <img src="/images/logo_toggle.png" class="login-logo" />
          <div class="login-content">
            <div class="login-content__text">Log på ROFUS med MitID</div>
            <img
              class="login-content__lock"
              src="/images/digital_signatur_lock.png"
              alt=""
            />
          </div>
        </a>

        <div class="login-container-description-wrapper">
          <!-- breaking convention, sorry -->
          <div class="login-container__description">
            <strong>
              I ROFUS kan du frivilligt udelukke dig selv fra onlinespil,
              fysiske kasinoer og væddemål i fysiske butikker i Danmark.
            </strong>
            <ul class="spacious-list">
              <li>Tag en 24 timers spillepause</li>
              <li>Midlertidig udelukkelse i 1, 3 eller 6 måneder</li>
              <li>Endelig udelukkelse</li>
            </ul>
            <a
              class="button login-container__button"
              href="https://rofusweb.spillemyndigheden.dk/public/rofus/"
            >
              Registrér med MitID
            </a>

            <p class="login-container__disclaimer">
              Vær opmærksom på, at Spillemyndigheden tager forbehold for
              eventuelle tekniske fejl i ROFUS og kan således ikke holdes
              ansvarlig for dette
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
